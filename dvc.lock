schema: '2.0'
stages:
  preprocess:
    cmd: python -m src.preprocess
    deps:
    - path: data/raw-data
      md5: 195da5ca95fad28f1cfe6f0f9ca2af8c.dir
      size: 1109264
      nfiles: 23
    - path: src/preprocess.py
      md5: 1274c9f6d80915beba6e78a9c97ce4e7
      size: 16362
    params:
      params.yaml:
        preprocess.DATA_YEAR_START_PP: 2012
        preprocess.HOW_IMPUTE_NAN: sazonalidade
        preprocess.TEST_START_PP: '2021-03-12'
        preprocess.VAL_START_PP: '2019-03-01'
    outs:
    - path: data/preprocessed/test_preprocessed.csv
      md5: bcc918fd2e437457ad49c3595677c804
      size: 19863
    - path: data/preprocessed/train_preprocessed.csv
      md5: 012417e7564d2222ad118e593a24eadc
      size: 120257
    - path: data/preprocessed/val_preprocessed.csv
      md5: c44c047a24980a3f80b2d199413dc662
      size: 35019
    - path: data/target/target_df.csv
      md5: 6da79f0ab5c3872f114cafe5a7f93a0d
      size: 78647
  featurize:
    cmd: python -m src.featurize
    deps:
    - path: data/preprocessed/test_preprocessed.csv
      md5: bcc918fd2e437457ad49c3595677c804
      size: 19863
    - path: data/preprocessed/train_preprocessed.csv
      md5: 012417e7564d2222ad118e593a24eadc
      size: 120257
    - path: data/preprocessed/val_preprocessed.csv
      md5: c44c047a24980a3f80b2d199413dc662
      size: 35019
    - path: src/featurize.py
      md5: 4e041129cf05317a9479d9b7509572bf
      size: 8857
    params:
      params.yaml:
        featurize.BATCH_SIZE_PRO: 32
        featurize.HOW_INPUT_WINDOW_GEN: weekly
        featurize.HOW_TARGET_WINDOW_GEN: weekly
        featurize.SUFFLE_BUFFER_PRO: 20
        featurize.TARGET_PERIOD: 1
        featurize.WINDOW_SIZE: 7
    outs:
    - path: data/featurized/test_processed.csv
      md5: 0a4a5ec670235ab0a54d8b94d32b6ae5
      size: 8162
    - path: data/featurized/train_processed.csv
      md5: 3bb1a4a0b15a3d3928def56942bf9d87
      size: 55130
    - path: data/featurized/val_processed.csv
      md5: 9e5e5796ba4d7f2b2f6e5c3e507fc413
      size: 15345
  train:
    cmd: python -m src.train
    deps:
    - path: data/featurized/test_processed.csv
      md5: 0a4a5ec670235ab0a54d8b94d32b6ae5
      size: 8162
    - path: data/featurized/train_processed.csv
      md5: 3bb1a4a0b15a3d3928def56942bf9d87
      size: 55130
    - path: data/featurized/val_processed.csv
      md5: 9e5e5796ba4d7f2b2f6e5c3e507fc413
      size: 15345
    - path: src/train.py
      md5: 18109841c35602d402179250a2aa7009
      size: 4530
    params:
      params.yaml:
        train.EPOCHS: 150
        train.MODEL_NAME: model_train.h5
        train.NEURONS:
        - 8
        train.PATIENCE: 8
    outs:
    - path: evaluation/history.json
      md5: c7ea8a337e6a631346843a997027b278
      size: 12880
    - path: evaluation/history_params.json
      md5: 41d9ece2f55379dc8101177ded15e2d1
      size: 42
    - path: src/model/model_train.h5
      md5: 1c01a37dc1ddb8056b8b538ffee2de1d
      size: 45712
