schema: '2.0'
stages:
  preprocess:
    cmd: python src/preprocess.py
    deps:
    - path: data/raw-data
      md5: 195da5ca95fad28f1cfe6f0f9ca2af8c.dir
      size: 1109264
      nfiles: 23
    - path: src/preprocess.py
      md5: 693a07ade9192f28ea526b48d9703e5b
      size: 13878
    params:
      params.yaml:
        preprocess.DATA_YEAR_START_PP: 2012
        preprocess.HOW_IMPUTE_NAN: sazonalidade
        preprocess.TEST_START_PP: '2021-03-12'
        preprocess.VAL_START_PP: '2019-03-01'
    outs:
    - path: data/preprocessed
      md5: de2579600b3d94b31c6c41734e33e3d6.dir
      size: 196379
      nfiles: 3
    - path: data/target_df.csv
      md5: 6da79f0ab5c3872f114cafe5a7f93a0d
      size: 79180
  featurize:
    cmd: python src/featurize.py
    deps:
    - path: data/preprocessed
      md5: de2579600b3d94b31c6c41734e33e3d6.dir
      size: 196379
      nfiles: 3
    - path: src/featurize.py
      md5: cb0aca0160ed7ddba114bacb9cb52d72
      size: 9354
    params:
      params.yaml:
        featurize.BATCH_SIZE_PRO: 32
        featurize.HOW_WINDOW_GEN_PRO: autorregressivo
        featurize.SUFFLE_BUFFER_PRO: 20
        featurize.TARGET_PERIOD_PRO: 1
        featurize.WINDOW_SIZE_PRO: 35
    outs:
    - path: data/featurized
      md5: 517c1592a4a69ca0db32764b1609815a.dir
      size: 223436
      nfiles: 16
  train:
    cmd: python src/train.py
    deps:
    - path: data/featurized
      md5: 517c1592a4a69ca0db32764b1609815a.dir
      size: 223436
      nfiles: 16
    - path: data/target_df.csv
      md5: 6da79f0ab5c3872f114cafe5a7f93a0d
      size: 79180
    - path: src/train.py
      md5: 3934c1d53e071d3f4596af890b9ac616
      size: 9827
    params:
      params.yaml:
        train.EPOCHS: 150
        train.MODEL_NAME: model_train.h5
        train.NEURONS:
        - 32
        train.PATIENCE: 30
    outs:
    - path: src/model
      md5: a578f296f000db05a8cf56d3f61a3adc.dir
      size: 94864
      nfiles: 1
    - path: src/valuation
      md5: c9e12f5abe6e0b33ad1a162e9f87d2b5.dir
      size: 1148347
      nfiles: 4
